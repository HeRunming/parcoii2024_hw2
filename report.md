# Homework2 Report
**何润明 2100010636**

## 问题描述
我们需要基于MPI来实现一维前缀和计算的并行计算算法。依据作业给出的代码，此问题中定义的一维数组的数据类型为整型。

## 并行思路与任务划分
注意到前缀和的计算可以分段进行，即先分段计算前缀和，再在每一段内加上前面所有数的和。我们可以考虑按照以下步骤来计算完整的前缀和：
- 将数表分为k段，在每一段内计算段内的前缀和
- 计算每一段需要增加的量。即取出每一段最后的一个数，对这k个数求一次前缀和，将这个前缀和更新到每一段的最后一位，此时最后一位已经被更新为所需的前缀和
- 最后再在每一段内更新剩下的变量，即加上前一段的最后一个数即可
  
考虑到MPI的特性，我们需要考虑优化线程通信的开销，因此我们最后的完整步骤如下：
- 生成数据。按照题目要求，我们每一个线程处理的数据应该在线程内进行。我们首先在每个线程内计算需要生成的数据的数量，随后生成随机数并保存在一个线程私有的数组内。
- 打印数据。由于输出数据的部分不计时也不要求优化。因此我们使用较为简单的方法输出，即将所有的数据都发送到rank=0的线程。
- 在每个线程内，求线程内数据的前缀和。此过程是并行的
- 除第一个线程外，更新每个线程内最后一个数据，即前k-1个线程发送数据，后k-1个线程接受数据，接受更新以后才能发送。此过程除更新随后一个数据之外，还需要一个额外的long类型的空间来存储前一组数据的最后一个数，用于后续更新。此步骤只能串行进行，并且需要进行k-1组传输和接受。
- 在每组内，除最后一个数外都加上此前保存的前一组数的最后一个数。

## 实验结果
我们为了方便进行后续测试，将输出重定向到了文件中而非屏幕上。我们统一将输出保存为out.txt，随后使用编写的正确性检验脚本来检查输出结果的正确性。我们